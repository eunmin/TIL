# KNN 알고리즘


## 01. 오렌지와 자몽 분류하기

어떤 과일이 하나 있다. 이 과일이 오렌지일까 자몽일까?
일반적으로 더 크고 붉은 과일이 자몽이다. 그래프 상에서 주변을 살펴보는 방법을 쓸 수 있다.
주변을 둘러보니 가장 가까운 이웃(neighbor)이 3개 있다.
3개 중에는 자몽 보다 오렌지가 많다. 그러면 이 과일은 아마도 오렌지일 것이다.

KNN 알고리즘(K-nearest neighbors algorithm)은 간단하면서 유용하다.
무언가를 분류해야 한다면 우선 KNN 알고리즘을 사용해볼 수 있다.


## 02. 추천 시스템 만들기

넷플릭스에서 고객을 위한 영화 추천 시스템을 만든다고 가정하자.
유사도를 이용해서 고객을 그래프 상에 표현할 수 있다.
고객과 가장 가까이 있는 다섯 명의 고객을 찾고 그 고객이 좋아하는 영화를 추천해주면 된다.

하지만 두 고객 사이의 유사도는 어떻게 구할까?

### 특징 추출
자몽문제에서는 과일의 크기와 붉은 정도를 통해 과일을 분류했다.
두 가지를 점수화하면 2차원 그래프로 표현할 수 있다.
그래프에 그려진 각 과일들간의 거리는 피타고라스의 정리로 계산할 수 있다.
거리 공식은 눈으로 알 수 있는 사실을 다시 한 번 확인해준다.

이번에는 넷플릭스 고객을 비교한다고 가정하자.
고객이 넷플릭스에 등록할 때 영화 장르에 대한 선호도를 평가하도록 한다. 그럼 모든 고객은 각 장르에 대한 평가 점수를 갖게 된다. 다섯가지 장르로 구분했다면 이제 5차원 상에서 거리를 측정해야 한다. 이 역시 거리공색을 사용해서 거리를 구할 수 있다.


### 회귀 분석

KNN은 분류와 회귀(regression) 두 가지 기능이 있다.
- 분류 = 그룹으로 나누기
- 회귀 = (숫자로 된) 반응을 예측하기

여러분이 빵집을 하고 있고 매일 빵을 만든다고 가정하자. 오늘은 빵을 몇 개 만들어야 할지 예측하고 싶다.
- 1점부터 5점까지 숫자로 표현한 날씨
- 주말 or 휴일인지 (주말이나 휴일은 1, 평일은 0)
- 스포츠 경기가 있는지 (있으면 1, 없으면 0)

그리고 각 날짜별 위의 특성이 어땠고 각 날짜에 팔린 빵 갯수를 알고 있으면 오늘 만들어야 할 빵의 개수를 예측할 수 있다.


TIP) 코사인 유사도

두 고객 사이의 거리를 비교할 때 거리 공식을 사용했는데, 이게 가장 좋은 공식일까?
실무에서 더 흔히 사용하는 것은 코사인 유사도(cosine similarity)다. 두 고객이 아주 비슷하지만 한 명은 평점을 주는데 매우 인색하다고 가정한다. 만약 거리 공식을 사용한다면 두 고객은 취향이 비슷함에도 불구하고 이웃이 되지 않을 수도 있다.
코사인 유사도는 두 벡터의 거리를 측정하는 것이 아니라 두 벡터 사이의 각도를 측정한다. 이런 경우에는 코사인 유사도가 더 적합한 방법이다.


### 좋은 특징 고르기

KNN을 사용할 때는 올바른 특징을 고르는 것이 중요하다.
- 추천하고자 하는 영화와 직접 관련이 있는 특징
- 편향되지 않은(e.g. 코미디 영화에 대한 평점만 있다거나 액션 영화에 대한 평점만 있는 경우) 특징

영화를 추천하는데 평점이 가장 좋은 방법일까? 예를 들어 내가 A보다 B드라마에 더 높은 평점을 주었지만 실제로는 A를 훨씬 많은 시간 시청하고 있을 수 있다. 즉 좋은 특징을 골라내야 더 좋은 추천 시스템을 만들 수 있다.


## 03. 머신러닝의 소개

KNN은 유용한 알고리즘인 동시에 머신 러닝(machine learning)의 세계로 안내하는 알고리즘이기도 하다. 앞서 추천 시스템을 통해서 머신러닝의 한 가지 예를 접해보았고, 다른 예들도 살펴보자.

### OCR

OCR은 광학적 문자 인식(Optical Character Recognition)의 약자다. 책의 페이지를 사진으로 찍으면 컴퓨터가 자동으로 그 사진 속의 글자를 읽어주는 것이다. OCR은 다음과 같이 동작한다.
- 여러 가지 숫자 그림을 살펴보고 이 그림들의 특징을 뽑는다.
- 새로운 그림이 주어지면 그 그림의 특징을 뽑아서 가장 가까운 것들을 살펴본다.

보통 OCR 알고리즘은 직선, 점, 곡선 등을 찾아낸다. OCR의 첫 번째 단계는 숫자 그림으로부터 특징을 추출하면서 모든 데이터를 살펴보는 것이다. 이것을 트레이닝(training)이라고 한다.


### 스팸 필터 만들기

스팸 필터는 나이브 베이즈 분류기(Naive Bayes classifier)라고 하는 간단한 알고리즘을 사용한다. 만약 '백만 달러를 벌어보세요!'라는 제목의 메일이 오면 이 문장을 단어로 쪼갠다. 그리고 각 단어마다 그 단어가 스팸 메일에 나타날 확률을 구한다.

과일을 분류할 때도 나이브 베이즈 분류기를 사용할 수 있다. 만약 크고 붉은 과일이 있으면 그 과일이 자몽일 확률도 구할 수 있다.


### 주식 시장 예측하기

머신러닝으로 하기 힘든 일도 있다. 내일 주식 시장이 오를지 내릴지 맞추는 일이다.
과거의 정보를 사용해서 확실히 미래를 맞출 수 있다고 보장할 수는 없다. 미래를 예측하는 일 자체가 힘들고, 특히 많은 변수가 관련되어 있는 경우에는 사실상 예측이 불가능하다. 
